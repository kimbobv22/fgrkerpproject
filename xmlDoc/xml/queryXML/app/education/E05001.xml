<?xml version="1.0" encoding="UTF-8"?>
<queryList keyName="app.education.E05001">

<query keyName="getAttendList">
SELECT   APY.MIS_ID
		,RST.EDU_ID
		,RST.EDU_DID
		,APY.MEM_SID
		,APY.FEE_YN
		,APY.BOOKREPORT_YN
		,APY.STATUS APLY_STATUS
		,ATFUNC_Z_GETGCODEDNM('A0003',APY.STATUS) APLY_STATUS_NM
		,APY.APPLY_CTG
		,ATFUNC_Z_GETGCODEDNM('A0001',APY.APPLY_CTG) APLY_CTG_NM
		,BSC.NAME
		,BSC.PHOTO_ID
		,BSC.PHONE1
		,BSC.PHONE2
		,BSC.BELONG_CTG1
		,BSC.BELONG_CTG2
		,BSC.BELONG_CTG3
		,RST.STATUS ATTEND_STATUS
		,RST.REG_DATE
		,RST.MOD_DATE
FROM  AT_APPLY APY
LEFT OUTER JOIN ATV_APPLY_BSC BSC
ON    APY.MIS_ID = BSC.MIS_ID
AND   APY.MEM_SID = BSC.MEM_SID
LEFT OUTER JOIN (
	SELECT  EDU.MIS_ID
			,EDU.EDU_ID
			,EDU.EDU_DID
			,RST.MEM_SID
			,RST.STATUS
			,RST.REG_DATE
			,RST.MOD_DATE
	FROM AT_EDUCATION_DTL EDU
	LEFT OUTER JOIN AT_EDUCATION_RST RST
	ON    EDU.MIS_ID = RST.MIS_ID
	AND   EDU.EDU_ID = RST.EDU_ID
	AND   EDU.EDU_DID = RST.EDU_DID
	WHERE 1=1
	AND   EDU.MIS_ID = #{misId}
	AND   EDU.EDU_ID = #{eduId}
	AND   EDU.EDU_DID = #{eduDid}
) RST
ON    APY.MIS_ID = RST.MIS_ID
AND   APY.MEM_SID = RST.MEM_SID
WHERE 1=1
AND   APY.MIS_ID = #{misId}
AND   IF(BSC.NAME = '', NULL, BSC.NAME) IS NOT NULL
</query>

<query keyName="updateAttend">
CALL ATPROC_E_UPDATEATTEND(#{misId},#{eduId},#{misDid},#{memSid},#{status});
</query>

</queryList>